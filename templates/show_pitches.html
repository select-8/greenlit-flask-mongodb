{% extends 'base.html' %}
{% block content %}

{% macro sentence_case(text) %}
{{ text[0]|upper}}{{text[1:] }}
{% endmacro %}

<div class="row">
    <div class="col-12 flash-del">
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <h5 class=flashes>
            {% for message in messages %}
            {{ message }}
            {% endfor %}
        </h5>
        {% endif %}
        {% endwith %}
    </div>
</div>

<br>
<h3>Pitches</h3>
<h4>Welcome back {{ session['username']|title }}.</h4>
<br>
<button><a href="{{ url_for('add_pitch') }}">Add New Pitch</a></button>
<button><a href="{{ url_for('show_pitches', sort_field='created_at') }}">Sort by votes</a></button>
<button type="button"><a href="{{ url_for('show_pitches', sort_field='last_modified') }}">Sort by last
        update</a></button>
<br>
<div class="container" id="make-reorderable-by-rating">
    {# https://shubhamjain.co/til/capitalizing-first-letter-in-jinja/ #}
    {% for pitch in pitches %}
    {% if pitch.is_del == false %}
    <hr style="border: 2px dashed black">
    <div class="pitch-collection">
        <div class="row">
            <div class="col-2">
                <button type="button"><a href="{{ url_for('edit_pitch', pitch_id=pitch._id) }}">Edit this
                        pitch</a></button>
            </div>
            <div class="col-1"></div>
            <form action="{{ url_for('hide_pitch', pitch_id=pitch._id) }}" method="POST">
                <button type="submit">Remove this pitch</button>
            </form>
        </div>
        <br>
        <div class="row">
            <div class="col-12">
                <h3 class="title">{{ pitch.title|title }}</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <p>A {{ pitch.genre_name|title }} movie to be directed by {{ pitch.director_name }} and starring
                    {{ pitch.actor }}.</p>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <p>{{ sentence_case(pitch.description) }}</p>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <p>{{ pitch.tag.film1 }} meets {{ pitch.tag.film2 }} {{ pitch.tag.location|title }}</p>
            </div>
            <div class="col-12">
                <img src="{{ url_for('static', filename = pitch.imgs.tag_img1.img ) }}"
                    onerror="this.onerror=null;this.src='https://placeimg.com/200/300/animals';" width="200px"
                    height="100px">
                <img src="{{ url_for('static', filename = pitch.imgs.tag_img2.img ) }}"
                    onerror="this.onerror=null;this.src='https://placeimg.com/200/300/animals';" width="200px"
                    height="100px">
                <img src="{{ url_for('static', filename = pitch.imgs.loc_img.img ) }}"
                    onerror="this.onerror=null;this.src='https://placeimg.com/200/300/animals';" width="200px"
                    height="100px">
            </div>
        </div>
    </div>
    {% endif %}
    {% endfor %}
</div>
<div>
    <div class="row">
        <div class="col-12">

        </div>
    </div>
</div>

{% endblock %}